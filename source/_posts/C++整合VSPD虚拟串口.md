---
title: C++整合VSPD虚拟串口
date: 2018-03-21 15:20:05
categories: C++
tags: 串口
---

> 现在除了一些台式机带串口的电脑现在已经不是很多了，有时候我们需要在没有串口的电脑上使用串口的方式进行数据交换和处理，那么虚拟串口就可以解决这个问题。 那么如何用代码进行串口的创建删除呢？

<!--more-->

**本文使用的软件是由Eltima Software提供的Virtual Serial Port Driver**

## 一、 通过VSPD创建删除虚拟串口
1. 通过VSPD提供的界面我们就可以简单进行虚拟串口的创建和删除
![](http://otfqaruit.bkt.clouddn.com/vspd1.jpg)

> 但是如果我们的程序面向的是不懂这些的用户的话，让他们去进行对应的操作就会不太友好了。
那么如何通过代码去实现这些操作呢？可能有人会第一个联想到是否有对应的命令行。 这是开发人员会第一时间想到的，这样用户只需要下一步下一步的安装好就行了，我们通过对应的命令行去进行我们想要的操作。 
可是我查阅之后并没有找到VSPD提供对应的东西，反而在帮助里找到了更好的方法，VSPD提供了接口可以集成到我们的软件中。

## 二、VSPD帮助说明
![](http://otfqaruit.bkt.clouddn.com/vspd2.jpg)


## 三、 集成操作
 VSPD提供了多个开发语言的示例，这边只以C++为展示
![](http://otfqaruit.bkt.clouddn.com/vspd3.jpg)


这样我们只需要用户安装此软件就行了，剩下的操作我们就可以通过代码去完成，减少用户的操作。

## 四、 问题
通过代码创建好的虚拟串口可以使用了，但是当机器重启之后发现对应创建好的虚拟串口没有了？  why？ 难道每次运行程序都要创建一遍吗？那岂不是很不好呢。
所以还有重要的一步，将创建的串口信息写入注册表

![](http://otfqaruit.bkt.clouddn.com/vspd4.jpg)

这样重启之后创建好的虚拟串口就依然还在了。